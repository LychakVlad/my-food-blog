(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[972],{6904:function(e,t,r){Promise.resolve().then(r.bind(r,2565))},2565:function(e,t,r){"use strict";r.r(t);var s=r(7437),i=r(2265),a=r(4033),n=r(2645),l=r(1865);t.default=()=>{let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),r=t.get("id"),o=(0,l.cI)();(0,i.useEffect)(()=>{let e=async()=>{let e=await fetch("/api/recipe/".concat(r)),t=await e.json();o.reset({title:t.title,description:t.description,tag:t.tag,steps:t.steps,ingredients:t.ingredients,photo:t.photo,_id:t._id,creator:t.creator,servings:t.servings.servings,yield:t.servings.yield,prepTime:t.timeToDo.prepTime,cookTime:t.timeToDo.cookTime,calories:t.nutrition.cal,protein:t.nutrition.protein,carbs:t.nutrition.carbs,fats:t.nutrition.fats})};r&&e()},[r]);let c=async t=>{if(!r)return alert("Recipe ID not found");try{let s=await fetch("/api/recipe/".concat(r),{method:"PATCH",body:JSON.stringify({title:t.title,description:t.description,tag:t.tag,steps:t.steps,ingredients:t.ingredients,photo:t.photo,_id:t._id,creator:t.creator,servings:{servings:t.servings,yield:t.yield},timeToDo:{prepTime:t.prepTime,cookTime:t.cookTime},nutrition:{cal:t.calories,protein:t.protein,carbs:t.carbs,fats:t.fats}})});s.ok&&e.push("/")}catch(e){console.log("Failed to update recipe",e)}};return(0,s.jsx)(n.Z,{type:"Edit",onSubmit:c,form:o})}},2645:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var s=r(7437),i=r(1396),a=r.n(i);r(2265);var n=r(4782),l=r(9479),o=r(1865),c=r(6691),d=r.n(c),p={src:"/_next/static/media/close.37385623.svg",height:24,width:24,blurWidth:0,blurHeight:0},u=e=>{let{data:t,register:r,name:i,control:a}=e,{fields:n,append:c,remove:u}=(0,o.Dq)({name:i,control:a,rules:{minLength:1}});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"font-satoshi font-semibold text-base text-gray-700",children:t.label}),(0,s.jsx)("p",{className:" opacity-50",children:t.description}),(0,s.jsxs)("div",{className:"flex  flex-col",children:[n.map((e,t)=>(0,s.jsx)("div",{children:(0,s.jsxs)("section",{className:"flex items-center mt-5",children:[(0,s.jsx)(l.Z,{register:r,placeholder:"Add one more",name:"".concat(i,".").concat(t),className:"form_input w-full",type:"text",required:!0}),1!==n.length&&(0,s.jsx)("button",{type:"button",onClick:()=>u(t),className:"h-full px-4",children:(0,s.jsx)(d(),{src:p,width:36,height:36,className:"rounded-full",alt:"close-icon"})})]},e.id)},e.id)),(0,s.jsxs)("button",{type:"button",className:"outline_btn mt-8",onClick:()=>c("Add ".concat(i.slice(0,-1))),children:["Add ",i.slice(0,-1)]})]})]})},m=r(3131),h=(0,n.Z)(e=>{let{type:t,onSubmit:r,form:i}=e,{register:n,handleSubmit:o,control:c,formState:{errors:d,isSubmitting:p}}=i;return(0,s.jsxs)("section",{className:"w-full max-w-fill flex-start flex-col",children:[(0,s.jsx)("h1",{className:"head_text text-left",children:(0,s.jsxs)("span",{className:"blue_gradient",children:[" ",t," Post"]})}),(0,s.jsxs)("p",{className:"desc text-left max-w-md","data-testid":"form-title",children:[t," and share your best recipes"]}),(0,s.jsxs)("form",{onSubmit:o(r),className:"mt-10 w-full max-w-2xl flex flex-col gap-7 glassmorphism",children:["Create"===t&&(0,s.jsx)(l.Z,{register:n,errors:null==d?void 0:d.photo,label:"Photo (optional)",type:"file",name:"photo",accept:"image/*",required:!1}),(0,s.jsx)(l.Z,{name:"title",register:n,errors:null==d?void 0:d.title,label:"Recipe Title",placeholder:"Enter the title",type:"text",required:!0,cytest:"title-input"}),(0,s.jsx)(m.Z,{placeholder:"Description...",label:"Description",register:n,name:"description",required:!0,errors:null==d?void 0:d.description,cytest:"description-input"}),(0,s.jsx)(u,{data:{label:"Ingredients",description:"Enter one ingredient per line. Include the quantity (i.e. cups, tablespoons) and any special preparation (i.e. sifted, softened, chopped). Use optional headers to organize the different parts of the recipe (i.e. Cake, Frosting, Dressing).",addButton:"Add ingredient"},register:n,control:c,name:"ingredients"}),(0,s.jsx)(u,{data:{label:"Directions",description:"Explain how to make your recipe, including oven temperatures, baking or cooking times, and pan sizes, etc. Use optional headers to organize the different parts of the recipe (i.e. Prep, Bake, Decorate).",addButton:"Add step",subTitle:"Step"},register:n,control:c,name:"steps"}),(0,s.jsx)(l.Z,{label:"Tag",desc:"(dinner, lunch, breakfast)",placeholder:"tag",name:"tag",type:"text",register:n,errors:null==d?void 0:d.tag,required:!0,cytest:"tag-input"}),(0,s.jsxs)("div",{className:"flex gap-10",children:[(0,s.jsx)(l.Z,{label:"Servings",placeholder:"10",type:"number",name:"servings",register:n,errors:null==d?void 0:d.servings,required:!0}),(0,s.jsx)(l.Z,{label:"Yield",placeholder:"Small bowls",type:"text",name:"yield",register:n,errors:null==d?void 0:d.yield,required:!0})]}),(0,s.jsxs)("div",{className:"flex gap-10",children:[(0,s.jsx)(l.Z,{label:"Time to prep (minutes)",placeholder:"120",type:"number",name:"prepTime",register:n,errors:null==d?void 0:d.prepTime,required:!0}),(0,s.jsx)(l.Z,{label:"Time to cook (minutes)",placeholder:"60",type:"number",name:"cookTime",register:n,errors:null==d?void 0:d.cookTime,required:!0})]}),(0,s.jsxs)("div",{className:"sm:flex sm:gap-10",children:[(0,s.jsx)(l.Z,{label:"Calories",name:"calories",placeholder:"200",type:"number",register:n,errors:null==d?void 0:d.calories,required:!0}),(0,s.jsx)(l.Z,{label:"Carbs",placeholder:"30",type:"number",name:"carbs",register:n,errors:null==d?void 0:d.carbs,required:!0}),(0,s.jsx)(l.Z,{label:"Protein",name:"protein",placeholder:"30",type:"number",register:n,errors:null==d?void 0:d.protein,required:!0}),(0,s.jsx)(l.Z,{name:"fats",register:n,errors:null==d?void 0:d.fats,label:"Fats",placeholder:"10",type:"number",required:!0})]}),(0,s.jsxs)("div",{className:"flex-end mx-3 mb-5 gap-4",children:[(0,s.jsx)(a(),{href:"/",className:"text-gray-500 text-sm",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"submit_btn","data-cy":"submit-form-btn",children:p?"".concat(t," is in process..."):t})]})]})]})})},4782:function(e,t,r){"use strict";var s=r(7437),i=r(2749),a=r(4033),n=r(2265);t.Z=function(e){return function(t){let{data:r}=(0,i.useSession)(),l=(0,a.useRouter)();return((0,n.useEffect)(()=>{r||l.push("/")},[]),r)?(0,s.jsx)(e,{...t}):null}}},9479:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{placeholder:t,label:r,type:i,desc:a,className:n,errors:l,name:o,register:c,autoComplete:d,required:p,accept:u,id:m,cytest:h}=e;return(0,s.jsxs)("div",{className:"w-full",children:[r&&(0,s.jsxs)("label",{htmlFor:o,className:"block text-sm font-medium leading-6 text-gray-900 mb-2",children:[r,(0,s.jsxs)("span",{className:"font-normal",children:[" ",a]})]}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("input",{...c(o,{required:!!p&&"".concat(o," is required")}),id:m,type:i,accept:u,autoComplete:d,placeholder:t,"data-cy":h,className:"form_input w-full  ".concat(n," ").concat(l&&"border-red-500"," ")}),l&&(0,s.jsx)("p",{className:"text-red-500 mt-2",children:"".concat(r," field is required")})]})]})}},3131:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{label:t,placeholder:r,register:i,name:a,required:n,errors:l,cytest:o}=e;return(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{className:"font-satoshi font-semibold text-base text-gray-700",children:t&&t}),(0,s.jsx)("textarea",{placeholder:r,...i(a,{required:!!n&&"".concat(a," is required")}),className:"form_textarea ".concat(l&&"border-red-500"," "),"data-cy":o}),l&&(0,s.jsx)("p",{className:"text-red-500 mt-2",children:"".concat(t," field is required")})]})}},4033:function(e,t,r){e.exports=r(8165)}},function(e){e.O(0,[661,685,599,971,596,744],function(){return e(e.s=6904)}),_N_E=e.O()}]);