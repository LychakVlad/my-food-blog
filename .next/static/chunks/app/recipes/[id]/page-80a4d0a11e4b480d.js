(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[836],{4546:function(e,t,l){Promise.resolve().then(l.bind(l,9831))},9831:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return v}});var s=l(7437),i=l(2265),a=l(6691),r=l.n(a),n=l(6620),c=l(1396),o=l.n(c),d=l(2749),m=e=>{let{rating:t,handleClick:l,clickable:i}=e;return(0,s.jsx)("div",{className:"flex items-center",children:[1,2,3,4,5].map(e=>(0,s.jsx)("svg",{className:"w-6 h-6 ".concat(e<=t?"text-yellow-300":"text-gray-300 dark:text-gray-500"," ms-1"),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 22 20",onClick:()=>i&&l?l(e):void 0,style:{cursor:i?"pointer":"default"},children:(0,s.jsx)("path",{d:"M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z"})},e))})};let h={1:(0,s.jsx)("p",{children:"Very bad recipe"}),2:(0,s.jsx)("p",{children:"Bad recipe"}),3:(0,s.jsx)("p",{children:"It's mid"}),4:(0,s.jsx)("p",{children:"I liked it"}),5:(0,s.jsx)("p",{children:"Really loved it"})};var u=e=>{let{rating:t}=e,l=h[t]||null;return l},x={src:"/_next/static/media/profile-undefined.8202436a.svg",height:20,width:20,blurWidth:0,blurHeight:0},p={src:"/_next/static/media/delete.608b57ef.svg",height:48,width:48,blurWidth:0,blurHeight:0},b=e=>{let{item:t,name:l,deleteComment:i}=e;return(0,s.jsxs)("div",{className:" border-gray-400 border mb-8 p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("div",{className:" overflow-hidden rounded-full w-[50px] h-[50px] relative mr-6",children:(0,s.jsx)(r(),{src:x,alt:"user_image",width:50,height:50,className:"absolute object-center left-0 top-0"})}),(0,s.jsx)("p",{className:"text-xl",children:t.creatorName})]}),l===t.creatorName&&(0,s.jsx)(r(),{src:p,width:36,height:36,className:"rounded-full mr-6 cursor-pointer",alt:"close-icon",onClick:e=>i(t._id),"data-cy":"delete-comment-".concat(t.text)})]}),(0,s.jsx)(m,{rating:t.rating,clickable:!1}),(0,s.jsxs)("p",{className:"my-3",children:[" ",(0,n.Z)(t.date)]}),(0,s.jsx)("p",{className:"text-lg","data-cy":"comment-cy-".concat(t.text),children:t.text})]})},f=l(3131),j=l(1865),g=l(2853),v=e=>{var t;let{post:l}=e,{register:a,handleSubmit:c,reset:h,formState:{errors:x,isSubmitting:p}}=(0,j.cI)(),[v,N]=(0,i.useState)(l.comments),[y,w]=(0,i.useState)(l.photo.base64?l.photo.base64:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),_=e=>fetch(e).then(e=>e.json()),A=[{label:"Cook time:",value:l.timeToDo.cookTime},{label:"Prep time:",value:l.timeToDo.prepTime},{label:"Total time:",value:Number(l.timeToDo.cookTime)+Number(l.timeToDo.prepTime)},{label:"Servings:",value:l.servings.servings},{label:"Yield:",value:l.servings.yield}],k=[{label:"Calories",value:l.nutrition.cal},{label:"Carbs",value:l.nutrition.carbs},{label:"Protein",value:l.nutrition.protein},{label:"Fats",value:l.nutrition.fats}],{data:S}=(0,d.useSession)(),[C,D]=(0,i.useState)(3);async function T(e){try{let t=await fetch("/api/comment",{method:"POST",body:JSON.stringify({creatorName:null==S?void 0:S.user.name,postId:l._id,text:e.review,rating:C})}),s=await t.json();N(e=>[...e,s]),h()}catch(e){console.log(e)}}async function L(e){let t=confirm("Are you sure you want to delete this comment?");if(t)try{await fetch("/api/comment",{method:"DELETE",body:JSON.stringify({id:e,postId:l._id})});let t=v.filter(t=>t._id!==e);N(t)}catch(e){console.log(e)}}return(0,s.jsxs)("div",{className:"max-w-2xl",children:[(0,s.jsxs)("h1",{className:"recipe_title",children:[l.title," "]}),(0,s.jsxs)("h3",{className:"mt-2 text-lg",children:["Recipe by ",null==l?void 0:null===(t=l.creator)||void 0===t?void 0:t.name]}),(0,s.jsxs)("p",{className:"mt-2",children:["Created ",(0,n.Z)(l.time)]}),(0,s.jsxs)("h3",{className:"mt-2 text-lg",children:["#",l.tag]}),(0,s.jsx)("p",{className:"desc mt-10 mb-4",children:l.description}),(0,s.jsx)("div",{className:"relative w-full min-h-full max-h-[900px] max-w-[600px]",children:(0,s.jsx)(e=>{let{Key:t}=e,{data:l}=(0,g.ZP)("/api/s3-bucket/".concat(t),_);return(0,s.jsx)(r(),{alt:"recipe-photo",src:(null==l?void 0:l.src)||"https://placehold.co/330x300/png?text=Picture",className:"object-cover",placeholder:"blur",blurDataURL:y,width:600,height:900})},{Key:l.photo.imageLink})}),(0,s.jsxs)("div",{className:"bg-gray-200 mt-10 p-8 ",children:[(0,s.jsx)("div",{className:"sm:grid-cols-3 sm:grid-rows-2 grid gap-8 mb-6 ",children:A.map((e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:e.label}),(0,s.jsxs)("p",{children:[e.value,"Servings:"==e.label||"Yield:"==e.label?null:" mins"]})]},t))}),(0,s.jsx)(o(),{href:"#nutrition",className:" underline",children:"Show nutrition information"})]}),(0,s.jsx)("h2",{className:"recipe_semi-title my-10",children:"Ingredients"}),(0,s.jsx)("ul",{children:l.ingredients.map((e,t)=>(0,s.jsxs)("li",{className:"mb-2 pl-5 relative",children:[(0,s.jsx)("span",{className:"before:absolute before:bg-gray-500 before:w-1.5 before:h-1.5 before:rounded-full before:left-1 before:top-2.5"}),e]},t))}),(0,s.jsx)("h2",{className:"recipe_semi-title my-10",children:"Directions"}),(0,s.jsx)("ol",{children:l.steps.map((e,t)=>(0,s.jsxs)("li",{className:"mb-10",children:[" ",(0,s.jsxs)("h4",{className:"recipe_step-title mb-2",children:[" ","Step "+(t+1)]}),(0,s.jsx)("p",{children:e})]},t))}),(0,s.jsx)("h2",{className:"recipe_semi-title my-10",children:"Nutrition"}),(0,s.jsx)("div",{className:"flex justify-between items-start mb-20 ",id:"nutrition",children:k.map((e,t)=>(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:[e.value," ","Calories"!==e.label?"g":null]}),(0,s.jsx)("p",{children:e.label})]},t))}),(0,s.jsx)("div",{className:"bg-gray-200 p-8 mb-16",children:(null==S?void 0:S.user)?(0,s.jsxs)("form",{onSubmit:c(T),className:"flex gap-10 flex-col",children:[(0,s.jsx)(f.Z,{placeholder:"Your review...",register:a,label:"Review",name:"review",required:!0,errors:x.review,cytest:"comment-cy-text"}),(0,s.jsxs)("div",{className:"sm:flex sm:flex-row flex-col items-center gap-8",children:[(0,s.jsx)(m,{rating:C,handleClick:e=>{D(e)},clickable:!0}),(0,s.jsx)("div",{className:" text-xl mt-6 ml-2 sm:mt-0 sm:ml-0",children:(0,s.jsx)(u,{rating:C})})]}),(0,s.jsx)("button",{type:"submit",className:"outline_btn ml-2 max-w-[100px]",disabled:p,"data-cy":"submit-comment-btn",children:"Send"})]}):(0,s.jsxs)("div",{"data-cy":"login-or-signup-required",children:["Please"," ",(0,s.jsx)(o(),{href:"/login",className:"underline",children:"log in"})," ","or"," ",(0,s.jsx)(o(),{href:"/sign-up",className:"underline",children:"sign up"})," ","to leave a comments!"]})}),v.map((e,t)=>(0,s.jsx)(b,{item:e,name:null==S?void 0:S.user.name,deleteComment:L},t))]})}},3131:function(e,t,l){"use strict";var s=l(7437);l(2265),t.Z=e=>{let{label:t,placeholder:l,register:i,name:a,required:r,errors:n,cytest:c}=e;return(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{className:"font-satoshi font-semibold text-base text-gray-700",children:t&&t}),(0,s.jsx)("textarea",{placeholder:l,...i(a,{required:!!r&&"".concat(a," is required")}),className:"form_textarea ".concat(n&&"border-red-500"," "),"data-cy":c}),n&&(0,s.jsx)("p",{className:"text-red-500 mt-2",children:"".concat(t," field is required")})]})}},6620:function(e,t,l){"use strict";function s(e){if("string"==typeof e){let t=new Date(e),l=t.getDate(),s=t.toLocaleString("en-US",{month:"short"}),i=t.getFullYear(),a="".concat(l," ").concat(s," ").concat(i);return a}}l.d(t,{Z:function(){return s}})}},function(e){e.O(0,[661,685,599,853,971,596,744],function(){return e(e.s=4546)}),_N_E=e.O()}]);